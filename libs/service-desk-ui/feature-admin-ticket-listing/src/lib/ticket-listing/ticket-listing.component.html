<ng-container *ngIf="loading$ | async as loading; else loaded">
  <lib-loading [loading]="loading" size="48px"></lib-loading>
</ng-container>

<ng-template #loaded>
  <ng-container *ngIf="loaded$ | async; else error">
    <section class="sd-pb-6" *ngIf="service$ | async as service" @contentBlockAnimation>
      <div class="container">
        <div class="d-flex flex-row align-items-start">
          <lib-section-header [header]="service.name" class="mr-auto"></lib-section-header>
          <!-- <a id="newCase" routerLink="claim_form/new" class="btn btn-gray-white">Новая заявка</a> -->
          <a id="newQuestion" routerLink="new" class="btn btn-gray-white ml-2">Новый вопрос</a>
          <a
            id="userMode"
            [routerLink]="['/categories', service.category_id, 'services', service.id]"
            class="btn btn-gray-white ml-2"
            >Перейти к услуге</a
          >
          <!-- <button class="btn btn-gray-white ml-2" (click)="toggleFilters = !toggleFilters" ngbTooltip="Фильтры">
            <i class="mdi mdi-filter-menu-outline"></i>
          </button> -->
        </div>
        <!-- <div class="d-flex flex-row align-items-center justify-content-end" *ngIf="toggleFilters" @ToggleAnswer>
          <div class="form-group align-items-center sd-icon-group pointer">
            <i
              *ngIf="!showOnlyMyQuestions"
              class="mdi mdi-toggle-switch-off mdi-24px"
              (click)="toggleshowOnlyMyQuestions()"
            ></i>
            <i
              *ngIf="showOnlyMyQuestions"
              class="mdi mdi-toggle-switch mdi-24px text-success"
              (click)="toggleshowOnlyMyQuestions()"
            ></i>
            <span (click)="toggleshowOnlyMyQuestions()">Показать только "свои" вопросы</span>
          </div>
        </div> -->
        <lib-responsible-user-list
          *ngIf="employeeLoaded$ | async"
          [responsibleUsers]="service.responsible_users"
          label="Ответственные за услугу"
        >
        </lib-responsible-user-list>

        <section class="sd-dlist-divider-b">
          <div class="mt-2">
            <lib-admin-question-list
              *ngIf="service.questions.length; else noQuestions"
              [questions]="service.questions"
              [attachmentLoadingIds]="attachmentLoadingIds$ | async"
              [employeeLoaded]="employeeLoaded$ | async"
              (publish)="publish($event)"
              (destroyPublished)="destroyPublished($event)"
              (destroyDraft)="destroyDraft($event)"
            ></lib-admin-question-list>
          </div>
        </section>
      </div>
    </section>
  </ng-container>
</ng-template>

<ng-template #error>
  <p class="text-danger">Не удалось загрузить данные</p>
</ng-template>

<ng-template #noQuestions>
  <p class="search-title">Список вопросов пуст</p>
</ng-template>

<p-confirmDialog #cd [style]="{ width: '50vw' }" [baseZIndex]="10000" [dismissableMask]="true">
  <ng-template pTemplate="footer">
    <button type="button" class="btn btn-gray-white" (click)="cd.reject()">Нет</button>
    <button type="button" class="btn btn-outline-primary" (click)="cd.accept()">Да</button>
  </ng-template>
</p-confirmDialog>
